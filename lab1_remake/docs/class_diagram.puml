@startuml
!theme plain

class Theater {
    - name: str
    - staff_manager: StaffManager
    - hall_manager: HallManager
    - performance_manager: PerformanceManager
    - ticket_manager: TicketManager
    - resource_manager: ResourceManager
    
    + add_staff(staff_member: Staff)
    + add_hall(hall: AuditoryHall)
    + add_setting(setting: Setting)
    + add_ticket(ticket: Ticket)
    + sell_ticket(ticket_id: str): bool
    + save_to_file(filepath: str)
    + load_from_file(filepath: str)
    + reset()
}

class StaffManager {
    - staff: List[Staff]
    
    + add_staff(staff_member: Staff)
    + get_staff(): List[Staff]
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): StaffManager
}

class HallManager {
    - halls: List[AuditoryHall]
    
    + add_hall(hall: AuditoryHall)
    + get_hall_by_id(hall_id: str): AuditoryHall
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): HallManager
}

class PerformanceManager {
    - settings: List[Setting]
    - repetitions: List[Repetition]
    
    + add_setting(setting: Setting)
    + add_repetition(repetition: Repetition)
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): PerformanceManager
}

class TicketManager {
    - tickets: List[Ticket]
    
    + add_ticket(ticket: Ticket)
    + get_all_tickets(): List[Ticket]
    + sell_ticket(ticket_id: str, hall_manager: HallManager): bool
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): TicketManager
}

class ResourceManager {
    - stages: List[Stage]
    - costume_rooms: List[CostumeRoom]
    - costumes: List[Costume]
    - hall_manager: HallManager
    
    + add_stage(stage: Stage)
    + add_costume_room(room: CostumeRoom)
    + add_costume(costume: Costume)
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): ResourceManager
}

class Staff {
    - name: str
    - __age: int
    - __salary: float
    
    + get_age(): int
    + get_salary(): float
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Staff
}

class Actor extends Staff {
    - role: str
    - assigned_costume: str
    
    + attend_repetition(repetition_id: str)
    + assign_costume(costume_id: str)
}

class Director extends Staff {
    - directed_settings: List[Setting]
    
    + direct_setting(setting: Setting)
}

class CostumeDesigner extends Staff {
    - created_costumes: List[Costume]
    
    + create_costume(costume: Costume)
}

class AuditoryHall {
    - name: str
    - sectors: int
    - rows_per_sector: int
    - seats_per_row: int
    - hall_id: str
    - seats: List[List[List[Seat]]]
    - audience_count: int
    - capacity: int
    
    + is_seat_available(sector: int, row: int, seat: int): bool
    + occupy_seat(sector: int, row: int, seat: int): bool
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): AuditoryHall
}

class Seat {
    - seat_number: int
    - is_occupied: bool
    
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Seat
}

class Ticket {
    {static} num: int
    - price: float
    - setting: Setting
    - sector: int
    - row: int
    - seat: int
    - hall_id: str
    - _hall: Optional[AuditoryHall]
    - is_sold: bool
    - ticket_id: str
    
    + set_ticket_id(tid: str)
    + link_hall(hall: AuditoryHall)
    + sell_ticket(): bool
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Ticket
}

class Setting {
    - durability: float
    - name: str
    - date: datetime
    - director: Director
    - cast: List[Actor]
    
    + add_cast(actor: Actor)
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Setting
}

class Repetition {
    - durability: float
    - name: str
    - date: datetime
    - setting: Setting
    - attendance_list: List[Staff]
    
    + check_list(actor: Staff)
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Repetition
}

class Stage {
    - name: str
    - capacity: int
    - equipment: List[str]
    - is_available: bool
    
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Stage
}

class Costume {
    - name: str
    - size: str
    - color: str
    
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): Costume
}

class CostumeRoom {
    - name: str
    - costume_ids: List[str]
    
    + to_dict(): Dict[str, Any]
    + from_dict(data: Dict[str, Any]): CostumeRoom
}

class TheaterException {
}

class InvalidSeatException extends TheaterException {
}

class TicketNotFoundException extends TheaterException {
}

Theater --> StaffManager
Theater --> HallManager
Theater --> PerformanceManager
Theater --> TicketManager
Theater --> ResourceManager

StaffManager --> Staff
HallManager --> AuditoryHall
PerformanceManager --> Setting
PerformanceManager --> Repetition
TicketManager --> Ticket
ResourceManager --> Stage
ResourceManager --> CostumeRoom
ResourceManager --> Costume
ResourceManager --> HallManager

Setting --> Director
Setting --> Actor
Repetition --> Setting
Repetition --> Staff
Ticket --> Setting
Ticket --> AuditoryHall
Actor --> Costume
Director --> Setting
CostumeDesigner --> Costume

@enduml